#include "MySSD1306.h"
#include <stdlib.h>

const int8_t charset[47][8] PROGMEM = {
	{0X3E,0X41,0X41,0X41,0X3E,0X00,0X00,0X00},	//0
	{0X00,0X42,0X7F,0X40,0X00,0X00,0X00,0X00},	//1
	{0X42,0X61,0X51,0X51,0X49,0X4E,0X00,0X00},	//2
	{0X00,0X41,0X41,0X49,0X49,0X36,0X00,0X00},	//3
	{0X08,0X0C,0X0A,0X7F,0X08,0X00,0X00,0X00},	//4
	{0X4F,0X49,0X49,0X49,0X31,0X00,0X00,0X00},	//5
	{0X3E,0X49,0X49,0X49,0X30,0X00,0X00,0X00},	//6
	{0X00,0X01,0X61,0X19,0X07,0X00,0X00,0X00},	//7
	{0X36,0X49,0X49,0X49,0X36,0X00,0X00,0X00},	//8
	{0X06,0X49,0X49,0X49,0X3E,0X00,0X00,0X00},	//9
	{0X00,0X00,0X00,0X66,0X00,0X00,0X00,0X00},	//:
	{0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00},	//space at 11
	{0XFF,0XC1,0XB1,0X8D,0X83,0XFF,0X00,0X00},	//null
	{0XFF,0XC1,0XB1,0X8D,0X83,0XFF,0X00,0X00},	//null
	{0XFF,0XC1,0XB1,0X8D,0X83,0XFF,0X00,0X00},	//null
	{0XFF,0XC1,0XB1,0X8D,0X83,0XFF,0X00,0X00},	//null
	{0XFF,0XC1,0XB1,0X8D,0X83,0XFF,0X00,0X00},	//null
	{0X7E,0X09,0X09,0X09,0X09,0X7E,0x00,0X00},	// A
	{0X7F,0X49,0X49,0X49,0X49,0X36,0X00,0X00},
	{0X3E,0X41,0X41,0X41,0X41,0X00,0X00,0X00},
	{0X7F,0X41,0X41,0X41,0X41,0X3E,0X00,0x00},
	{0X7F,0X49,0X49,0X49,0X41,0X41,0X00,0X00},	// E
	{0X7F,0X09,0X09,0X09,0X01,0X01,0X00,0X00},
	{0X3E,0X41,0X41,0X49,0X49,0X31,0X00,0X00},
	{0X7F,0X08,0X08,0X08,0X08,0X7F,0X00,0X00},
	{0X41,0X41,0X7F,0X41,0X41,0X00,0X00,0X00},
	{0X20,0X40,0X40,0X40,0X3F,0X00,0X00,0X00},
	{0X7F,0X08,0X14,0X22,0X41,0X00,0X00,0X00},
	{0X7F,0X40,0X40,0X40,0X40,0X00,0X00,0X00},	// L
	{0X7F,0X02,0X04,0X18,0X04,0X02,0X7F,0X00},
	{0X7F,0X03,0X0C,0X18,0X60,0X7F,0X00,0X00},
	{0X1C,0X22,0X41,0X41,0X41,0X22,0X1C,0X00},
	{0X7F,0X11,0X11,0X11,0X0E,0X00,0X00,0X00},
	{0X3E,0X41,0X41,0X51,0X21,0X5E,0X00,0X00},
	{0X7F,0X09,0X09,0X19,0X26,0X40,0X00,0X00},
	{0X26,0X49,0X49,0X49,0X49,0X32,0X00,0X00},
	{0X01,0X01,0X7F,0X01,0X01,0X00,0X00,0X00},	// T
	{0X3F,0X40,0X40,0X40,0X40,0X3F,0X00,0X00},
	{0X07,0X18,0X20,0X40,0X20,0X18,0X07,0X00},
	{0X7F,0X20,0X10,0X08,0X10,0X20,0X7F,0X00},
	{0X41,0X22,0X14,0X08,0X14,0X22,0X41,0X00},
	{0X01,0X02,0X04,0X78,0X04,0X02,0X01,0X00},
	{0X41,0X61,0X51,0X49,0X45,0X43,0X00,0X00}, // Z
	{0X55,0XAA,0X55,0XAA,0X55,0XAA,0X55,0XAA}, // [
	{0X55,0X00,0XAA,0X00,0X55,0X00,0XAA,0X00},//\//
	{0X11,0X00,0X44,0X00,0X11,0X00,0X44,0X00}, // [
	{0X7E,0X81,0XA5,0XA1,0XA1,0XA5,0X81,0X7E}, //^
};

// must call displaybegin and end before and after calling this method
void writeString(char *str)
{
	uint8_t y = 0;
	int8_t alpha = 0;

	alpha = ((uint8_t) str[y]);

	while (alpha != 0) // loop till string terminates
	{
		alpha -= 48;// adjust for ascii 48
		
		if (alpha<0)
		{
			alpha = 11; // space char
		}
		
		for (uint8_t i = 0; i < 8; i++)
		{
			fastSPIwrite(pgm_read_byte( &(charset[alpha][i]) ));
		}
		
		y++;
		alpha = ((uint8_t) str[y]);	
	}	
}

// must call dislaybegin and end before and after this method
void writeNumber(uint16_t number)
{
	char chr[6];
	utoa(number,chr, 10);
	writeString(chr);
}

